<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC   
    "-//mybatis.org//DTD Mapper 3.0//EN"  
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.markbro.dzd.base.sysPara.dao.ParaMapper">
	<!--<sql id="addColumns">id,mk_dm,csdm,csz,cssm,createTime,deleted</sql> -->
	<!--<sql id="updateColumns">mk_dm,csdm,csz,cssm,deleted</sql> -->
	<cache type="com.markbro.asoiaf.mybatis.cache.AsoiafCache" eviction="org.apache.ibatis.cache.decorators.LruCache" readOnly="true" size="1024" flushInterval="3600000"/>
	<sql id="allColumns">id,mk_dm,csdm,csz,cssm,createTime,deleted</sql>
	<!--如果实体类中属性名与数据库表中的字段名不一致就需要用resultMap映射-->
	<resultMap id="paraResult" type="com.markbro.dzd.base.sysPara.bean.Para">
		<result property="id" column="id" />
		<result property="mk_dm" column="mk_dm" />
		<result property="csdm" column="csdm" />
		<result property="csz" column="csz" />
		<result property="cssm" column="cssm" />
		<result property="createTime" column="createTime" />
		<result property="deleted" column="deleted" />
	</resultMap>
    <sql id="Para_Where_Clause">
        <if test="id != null and id != ''">
				AND id = #{id}
		</if>
			<if test="mk_dm != null and mk_dm != ''">
				AND mk_dm = #{mk_dm}
		</if>
			<if test="csdm != null and csdm != ''">
				AND csdm like concat(concat('%',#{csdm}),'%')
		</if>
			<if test="csz != null and csz != ''">
				AND csz = #{csz}
		</if>
			<if test="cssm != null and cssm != ''">
				AND cssm = #{cssm}
		</if>
			<if test="createTime != null and createTime != ''">
				AND createTime = #{createTime}
		</if>
			<if test="deleted != null and deleted != ''">
				AND deleted = #{deleted}
		</if>
			
    </sql>
    <select id="get"  resultMap="paraResult">
        select <include refid="allColumns"/>
        from sys_para
        where
        id =#{id}
    </select> 
    <insert id="add" useGeneratedKeys="true" keyProperty="id" parameterType="com.markbro.dzd.base.sysPara.bean.Para" flushCache="true">
    	insert into sys_para(id,mk_dm,csdm,csz,cssm,createTime,deleted)
    	values (#{id},#{mk_dm},#{csdm},#{csz},#{cssm},now(),0)
    </insert>
    <insert id="addBatch" flushCache="true">
        insert into sys_para (id,mk_dm,csdm,csz,cssm,createTime,deleted)
        values
        <foreach collection="list" item="item" separator="," >
        	(#{item.id},#{item.mk_dm},#{item.csdm},#{item.csz},#{item.cssm},now(),0)
        </foreach>
    </insert>
    <update id="update" parameterType="com.markbro.dzd.base.sysPara.bean.Para" flushCache="true">
    	update sys_para 
    	<set>
    		<if test="mk_dm != null">mk_dm=#{mk_dm},</if>
			<if test="csdm != null">csdm=#{csdm},</if>
			<if test="csz != null">csz=#{csz},</if>
			<if test="cssm != null">cssm=#{cssm},</if>
			<if test="deleted != null">deleted=#{deleted},</if>
			
    	</set>
    	 where
    	id =#{id}
    </update>
	<update id="updateByMap" parameterType="map" flushCache="true">
        update sys_para
        <set>
            <if test="mk_dm != null">mk_dm=#{mk_dm},</if>
			<if test="csdm != null">csdm=#{csdm},</if>
			<if test="csz != null">csz=#{csz},</if>
			<if test="cssm != null">cssm=#{cssm},</if>
			<if test="deleted != null">deleted=#{deleted},</if>
			
        </set>
        where
        id =#{id}
    </update>
	<update id="updateByMapBatch" parameterType="map" flushCache="true">
         update sys_para
         <set>
         <if test="mk_dm != null">mk_dm=#{mk_dm},</if>
			<if test="csdm != null">csdm=#{csdm},</if>
			<if test="csz != null">csz=#{csz},</if>
			<if test="cssm != null">cssm=#{cssm},</if>
			<if test="deleted != null">deleted=#{deleted},</if>
			
         </set>
         where
         id in
         <foreach collection="ids" item = "id" open="(" separator="," close=")">
         #{id}
         </foreach>
    </update>
  	<delete id="delete" flushCache="true">
      	delete  from sys_para where id =#{id}
    </delete>
  	<delete id="deleteBatch" flushCache="true">
      	delete  from sys_para where id in
        <foreach collection="array" item = "ids" open="(" separator="," close=")">
        #{ids}
        </foreach>
    </delete>
    <select id="find" resultMap="paraResult" parameterType="java.util.Map">
        SELECT <include refid="allColumns"/> FROM sys_para
        <where>
            
            and deleted=0
            <include refid="Para_Where_Clause"/>
        </where>
    </select>
    <select id="findByMap" resultMap="paraResult"  parameterType="map" >
   		SELECT <include refid="allColumns"/> FROM sys_para
   		<where>
   		    <if test="id != null and id != ''">
				AND id = #{id}
			</if>
			<if test="mk_dm != null and mk_dm != ''">
				AND mk_dm = #{mk_dm}
			</if>
			<if test="csdm != null and csdm != ''">
				AND csdm like concat(concat('%',#{csdm}),'%')
			 </if>
			<if test="csz != null and csz != ''">
				AND csz = #{csz}
			</if>
			<if test="cssm != null and cssm != ''">
				AND cssm = #{cssm}
			</if>
			<if test="createTime != null and createTime != ''">
				AND createTime = #{createTime}
			</if>
			<if test="deleted != null and deleted != ''">
				AND deleted = #{deleted}
			</if>
			
   		</where>
   	</select>

	<select id="findByMk_dm" resultType="com.markbro.dzd.base.sysPara.bean.Para">
		select *
			from sys_para
		<where>
			mk_dm=#{mk_dm}
			and deleted=0
		</where>
	</select>
</mapper>
